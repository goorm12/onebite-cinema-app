name: Claude Code Review
on:
  pull_request:
    types: [opened, synchronize]
    # Optional: Only run on specific file changes
    # paths:
    #   - "src/**/*.ts"
    #   - "src/**/*.tsx"
    #   - "src/**/*.js"
    #   - "src/**/*.jsx"
jobs:
  claude-review:
    # Optional: Filter by PR author
    # if: |
    #   github.event.pull_request.user.login == 'external-contributor' ||
    #   github.event.pull_request.user.login == 'new-developer' ||
    #   github.event.pull_request.author_association == 'FIRST_TIME_CONTRIBUTOR'
    
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
      issues: read
      id-token: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1
      - name: Run Claude Code Review
        id: claude-review
        uses: anthropics/claude-code-action@beta
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          # Optional: Specify model (defaults to Claude Sonnet 4, uncomment for Claude Opus 4)
          # model: "claude-opus-4-20250514"
          
          # Direct prompt for automated review (no @claude mention needed)
          direct_prompt: |
            ## í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
            - **ê¸°ìˆ  ìŠ¤íƒ**: React + TypeScript + Zustand + Vanilla Extract + Next.js
            - **ì•„í‚¤í…ì²˜**: MVVM íŒ¨í„´ (View-ViewModel-Model)
          
            ## í•„ìˆ˜ ê²€í†  í•­ëª©
          
            ### ğŸ—ï¸ MVVM íŒ¨í„´ ì¤€ìˆ˜
            - `components/` (View): UI ë Œë”ë§ê³¼ ì´ë²¤íŠ¸ ì²˜ë¦¬ë§Œ
            - `hooks/` (ViewModel): ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, Zustand êµ¬ë…
            - `api/` (Model): ë°ì´í„° í†µì‹ ë§Œ ë‹´ë‹¹
            
            **View (components/)ì—ì„œ í—ˆìš©:**
            - ê°„ë‹¨í•œ UI ìƒíƒœ ë³€ê²½ í•¸ë“¤ëŸ¬
            - í¼ ì…ë ¥ ì²˜ë¦¬ í•¨ìˆ˜
            - ViewModel í•¨ìˆ˜ì˜ ë‹¨ìˆœ í˜¸ì¶œ
            - ê¸°ë³¸ì ì¸ ì´ë²¤íŠ¸ ì²˜ë¦¬
  
            **ViewModel (hooks/)ë¡œ ì´ë™ í•„ìš”:**
            - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ í¬í•¨ëœ í•¨ìˆ˜
            - ë°ì´í„° ë³€í™˜/ê³„ì‚° ë¡œì§
            - ë³µì¡í•œ ì¡°ê±´ë¶€ ì²˜ë¦¬
            - API í˜¸ì¶œ ë° ì—ëŸ¬ ì²˜ë¦¬
  
            ê°„ë‹¨í•œ UI í•¸ë“¤ëŸ¬ëŠ” Viewì—ì„œ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ,
            ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ í¬í•¨ë˜ë©´ ViewModelë¡œ ë¶„ë¦¬í•´ì£¼ì„¸ìš”.
          
            ### ğŸ“ ì½”ë“œ ê°€ë…ì„± (í•„ìˆ˜)
            - **ë³µì¡í•œ ë¡œì§**: ì™œ ê·¸ë ‡ê²Œ êµ¬í˜„í–ˆëŠ”ì§€ ì„¤ëª… ì£¼ì„ í•„ìˆ˜
            - **ë³€ìˆ˜ëª…**: ëª…í™•í•˜ê³  ì§ê´€ì  (ì˜ˆ: `isUserLoggedIn`, `studentExamResults`)
          
            ### ğŸ¯ ë„¤ì´ë° ì»¨ë²¤ì…˜
            - í´ë”: kebab-case (`class-manage`)
            - ì»´í¬ë„ŒíŠ¸: PascalCase (`StudentList.tsx`)
            - í•¨ìˆ˜/ë³€ìˆ˜: camelCase (`getUserData`)
            - API í•¨ìˆ˜: `api` ì ‘ë‘ì‚¬ (`apiGetStudents`)
            - ìƒìˆ˜: UPPER_CASE (`MAX_FILE_SIZE`)
            - Boolean: `is/has/can` ì ‘ë‘ì‚¬ (`isLoading`)
          
            ### âš¡ React/TypeScript ê·œì¹™
            - Zustand ì„ íƒì  êµ¬ë… ì‚¬ìš©
            - Recipe ìš°ì„  (Vanilla Extract)
            - ì—ëŸ¬ ì²˜ë¦¬ í•„ìˆ˜ (try-catch, ì—ëŸ¬ ë¡œê¹…)
            - props 2ê°œ ì´ìƒ ì‹œ interface ì •ì˜
          
            ## ë¦¬ë·° ìš”ì²­
            ìœ„ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì„ ì¤‘ì  ê²€í† í•´ì£¼ì„¸ìš”:
            - MVVM íŒ¨í„´ ìœ„ë°˜ ì—¬ë¶€
            - í•¨ìˆ˜ ì£¼ì„ ëˆ„ë½
            - ë„¤ì´ë° ì»¨ë²¤ì…˜ ìœ„ë°˜
            - ë³´ì•ˆ/ì„±ëŠ¥ ì´ìŠˆ
            - TypeScript íƒ€ì… ì•ˆì „ì„±
            
            **ì‘ë‹µ í˜•ì‹:**
            - ë°œê²¬ëœ ë¬¸ì œì ì„ í•œê¸€ë¡œ ëª…í™•í•˜ê²Œ ì„¤ëª…
            - ìˆ˜ì • ë°©ë²•ë„ í•œê¸€ë¡œ ì œì•ˆ
            - ì½”ë“œ ì˜ˆì‹œëŠ” ê·¸ëŒ€ë¡œ ë‘ë˜, ì„¤ëª…ì€ ëª¨ë‘ í•œê¸€ë¡œ
            - ìŠ¤íƒ€ì¼ì´ë‚˜ ì‚¬ì†Œí•œ ë¬¸ì œëŠ” ë¬´ì‹œí•˜ê³  ì‹¤ì œ ë¬¸ì œë§Œ ì§€ì 

            **ë¦¬ë·°ëŠ” ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.**
          
            **ìŠ¤íƒ€ì¼ì´ë‚˜ ì‚¬ì†Œí•œ ë¬¸ì œëŠ” ë¬´ì‹œí•˜ê³ , ì‹¤ì œ ë¬¸ì œê°€ ë  ìˆ˜ ìˆëŠ” ê²ƒë§Œ ê°„ê²°í•˜ê²Œ ì§€ì í•´ì£¼ì„¸ìš”.**
